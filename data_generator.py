"""\nE-Commerce Sales Data Generator\nGenerates 3 years of daily synthetic sales data (FY 2022-23, 2023-24, 2024-25)\nfor Indian e-commerce platform with seasonality, promotions, and regional variations.\n\nAuthor: Data Analytics Portfolio Project\nDate: 2025-11-14\n"""\n\nimport pandas as pd\nimport numpy as np\nfrom datetime import datetime, timedelta\nimport random\n\n# Set random seed for reproducibility\nnp.random.seed(42)\nrandom.seed(42)\n\n# Configuration\nSTART_DATE = '2022-04-01'  # FY 2022-23 start\nEND_DATE = '2025-03-31'     # FY 2024-25 end\n\n# Product Configuration (10 products)\nPRODUCTS = {\n    'PRD001': {'name': 'Samsung Galaxy M32', 'category': 'Electronics', 'base_price': 15999},\n    'PRD002': {'name': 'Levi Jeans', 'category': 'Fashion', 'base_price': 2499},\n    'PRD003': {'name': 'Nike Running Shoes', 'category': 'Fashion', 'base_price': 4999'},\n    'PRD004': {'name': 'boAt Headphones', 'category': 'Electronics', 'base_price': 1299},\n    'PRD005': {'name': 'Prestige Cooker', 'category': 'Home & Kitchen', 'base_price': 1899},\n    'PRD006': {'name': 'Dyson Vacuum', 'category': 'Home & Kitchen', 'base_price': 28999},\n    'PRD007': {'name': 'Fossil Watch', 'category': 'Fashion', 'base_price': 8999},\n    'PRD008': {'name': 'LG TV 43 inch', 'category': 'Electronics', 'base_price': 32999},\n    'PRD009': {'name': 'Milton Bottle', 'category': 'Home & Kitchen', 'base_price': 399},\n    'PRD010': {'name': 'OnePlus Earbuds', 'category': 'Electronics', 'base_price': 3999}\n}\n\n# Indian Cities\nCITIES = ['Mumbai', 'Delhi', 'Bangalore', 'Hyderabad', 'Chennai', 'Kolkata', 'Pune', 'Ahmedabad']\n\n# Customer Segments\nCUSTOMER_SEGMENTS = ['Premium', 'Mid-Tier', 'Budget', 'First-Time']\n\ndef get_seasonality_factor(date, product_category):\n    \"\"\"Calculate seasonality multiplier based on month and product category\"\"\"\n    month = date.month\n    \n    # Festival seasons in India\n    if month in [10, 11]:  # Diwali season (Oct-Nov)\n        base_factor = 1.8\n    elif month in [8, 9]:  # Festive season start\n        base_factor = 1.4\n    elif month in [12, 1]:  # New Year/Winter\n        base_factor = 1.3\n    elif month in [3, 4]:  # End of FY\n        base_factor = 1.2\n    elif month in [6, 7]:  # Monsoon\n        base_factor = 0.9\n    else:\n        base_factor = 1.0\n    \n    # Category-specific adjustments\n    if product_category == 'Electronics':\n        if month in [10, 11]:  # High demand during festivals\n            base_factor *= 1.2\n    elif product_category == 'Fashion':\n        if month in [8, 9, 10]:  # Wedding/Festival season\n            base_factor *= 1.15\n    elif product_category == 'Home & Kitchen':\n        if month in [10, 11, 12]:  # Home improvement season\n            base_factor *= 1.1\n    \n    return base_factor\n\ndef get_discount_factor(date):\n    \"\"\"Determine if promotion/discount is active\"\"\"\n    month = date.month\n    day = date.day\n    \n    # Major sale events\n    if month == 10 and 15 <= day <= 25:  # Diwali Sale\n        return 0.75, 'Diwali Sale'\n    elif month == 8 and day == 15:  # Independence Day\n        return 0.80, 'Independence Day Sale'\n    elif month == 1 and day == 26:  # Republic Day\n        return 0.80, 'Republic Day Sale'\n    elif month == 11 and 20 <= day <= 30:  # Black Friday\n        return 0.70, 'Black Friday'\n    elif month in [3, 6, 9, 12] and day == 1:  # Quarterly sales\n        return 0.85, 'End of Season Sale'\n    else:\n        return 1.0, None\n\ndef generate_daily_sales(date, products, cities, segments):\n    \"\"\"Generate sales transactions for a single day\"\"\"\n    sales_records = []\n    \n    for product_id, product_info in products.items():\n        # Base daily transactions (varies by product)\n        if product_info['base_price'] > 20000:\n            base_qty = np.random.randint(5, 15)\n        elif product_info['base_price'] > 5000:\n            base_qty = np.random.randint(10, 30)\n        else:\n            base_qty = np.random.randint(15, 50)\n        \n        # Apply seasonality\n        seasonality = get_seasonality_factor(date, product_info['category'])\n        adjusted_qty = int(base_qty * seasonality)\n        \n        # Get discount\n        discount_factor, promotion = get_discount_factor(date)\n        \n        # Generate transactions for this product across cities\n        for _ in range(adjusted_qty):\n            city = random.choice(cities)\n            segment = random.choice(segments)\n            \n            # Quantity per order\n            order_qty = np.random.choice([1, 2, 3], p=[0.7, 0.2, 0.1])\n            \n            # Calculate price with discount\n            unit_price = product_info['base_price'] * discount_factor\n            sales_amount = unit_price * order_qty\n            \n            record = {\n                'date': date,\n                'product_id': product_id,\n                'product_name': product_info['name'],\n                'category': product_info['category'],\n                'city': city,\n                'customer_segment': segment,\n                'quantity': order_qty,\n                'unit_price': round(unit_price, 2),\n                'sales_amount': round(sales_amount, 2),\n                'discount_percent': round((1 - discount_factor) * 100, 2),\n                'promotion': promotion if promotion else 'Regular'\n            }\n            sales_records.append(record)\n    \n    return sales_records\n\ndef generate_complete_dataset():\n    \"\"\"Generate complete 3-year sales dataset\"\"\"\n    print(\"Generating E-Commerce Sales Data...\")\n    print(f\"Date Range: {START_DATE} to {END_DATE}\")\n    print(f\"Products: {len(PRODUCTS)}\")\n    print(f\"Cities: {len(CITIES)}\")\n    \n    all_sales = []\n    \n    # Generate date range\n    start = datetime.strptime(START_DATE, '%Y-%m-%d')\n    end = datetime.strptime(END_DATE, '%Y-%m-%d')\n    current_date = start\n    \n    while current_date <= end:\n        daily_sales = generate_daily_sales(current_date, PRODUCTS, CITIES, CUSTOMER_SEGMENTS)\n        all_sales.extend(daily_sales)\n        current_date += timedelta(days=1)\n    \n    # Create DataFrame\n    df = pd.DataFrame(all_sales)\n    \n    # Add fiscal year\n    df['fiscal_year'] = df['date'].apply(lambda x: \n        f\"FY{x.year}-{str(x.year+1)[-2:]}\" if x.month >= 4 \n        else f\"FY{x.year-1}-{str(x.year)[-2:]}\"\n    )\n    \n    print(f\"\\nDataset Generated Successfully!\")\n    print(f\"Total Records: {len(df):,}\")\n    print(f\"Date Range: {df['date'].min()} to {df['date'].max()}\")\n    print(f\"Total Sales: â‚¹{df['sales_amount'].sum():,.2f}\")\n    \n    return df\n\nif __name__ == \"__main__\":\n    # Generate dataset\n    sales_df = generate_complete_dataset()\n    \n    # Save to CSV\n    sales_df.to_csv('data/ecommerce_sales_data.csv', index=False)\n    print(f\"\\nData saved to: data/ecommerce_sales_data.csv\")\n    \n    # Display sample\n    print(\"\\nSample Data:\")\n    print(sales_df.head(10))\n    \n    # Summary statistics\n    print(\"\\nSummary by Fiscal Year:\")\n    print(sales_df.groupby('fiscal_year').agg({\n        'sales_amount': ['sum', 'mean', 'count']\n    }).round(2))
